function init(){retrieveFromDB(),getCurrentPosition(),signIn(),signOut(),submitReport()}function retrieveFromDB(){var a=firebase.database().ref("reports/").limitToLast(100);a.on("child_added",function(a){addReportElement(a.val().lng)})}function addReportElement(a){$(".recent-reports").append("<p>"+a+"</p>")}function getCurrentPosition(){navigator.geolocation?navigator.geolocation.getCurrentPosition(saveGeoData):alert("Sorry, you do not have geolocation enabled for your browser")}function saveGeoData(a){reportData.lat=a.coords.latitude,reportData.lng=a.coords.longitude}function saveTextData(){reportData.msg=$("#new-report-message").val()}function sendToDB(){var a=firebase.database().ref().child("reports").push().key,b={};return b["/reports/"+a]=reportData,b["/user-reports/"+reportData.user+"/"+a]=reportData,firebase.database().ref().update(b)}function submitReport(){$("#submit-report").click(function(a){a.preventDefault(),console.log("Submit Report clicked!"),saveTextData(),sendToDB()})}function signIn(){$("#sign-in").click(function(){console.log("sign in clicked"),firebase.auth().signInAnonymously()})}function signOut(){$("#sign-out").click(function(){console.log("sign out clicked"),alert("User signed out!"),firebase.auth().signOut()})}function authStateChange(){firebase.auth().onAuthStateChanged(function(a){a&&(alert("User signed-in!"),writeUserData(a.uid),reportData.user=a.uid)})}function writeUserData(a){firebase.database().ref("users/"+a).set({userId:a})}var reportData={};$(function(){init()});